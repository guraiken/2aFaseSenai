CREATE DATABASE livraria2;

USE livraria2;

CREATE TABLE cliente(
id_cliente INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(80) NOT NULL,
rg INT, 
cpf BIGINT(11) UNIQUE,
pais VARCHAR(80) DEFAULT 'Brasil',
cidade VARCHAR(75),
bairro VARCHAR(75),
rua VARCHAR(75),
numero_casa INT
);

CREATE TABLE financiador(
id_financiador INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(80),
cnpj BIGINT(14)
);

CREATE TABLE autor(
id_autor INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(80) NOT NULL,
rg INT
);

CREATE TABLE editora(
id_editora INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
nome_fantasia VARCHAR(80) NOT NULL,
razao_social VARCHAR(80) NOT NULL,
pais VARCHAR(80) DEFAULT('Brasil'),
estado VARCHAR(80),
cidade VARCHAR(80),
rua VARCHAR(80),
numero_casa VARCHAR(80),
telefone BIGINT
);

CREATE TABLE livro(
id_livro INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
isbn BIGINT,
titulo VARCHAR(80),
preco DECIMAL(8,2),
categoria ENUM('Horror', 'Ficção', 'Romance', 'Ação'),
financiador_id INT,
autor_id INT,
editora_id INT,
FOREIGN KEY (financiador_id)
REFERENCES financiador(id_financiador),
FOREIGN KEY (autor_id)
REFERENCES autor(id_autor),
FOREIGN KEY (editora_id)
REFERENCES editora(id_editora)
);

CREATE TABLE pedido(
id_pedido INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
livro_id INT,
cliente_id INT,
qtd_pedido INT,
CHECK (qtd_pedido >=0),
FOREIGN KEY (livro_id)
REFERENCES livro(id_livro),
FOREIGN KEY (cliente_id)
REFERENCES cliente(id_cliente)
);

ALTER TABLE livro 
MODIFY COLUMN preco DECIMAL(8,2) CHECK (preco >=0);

ALTER TABLE editora
MODIFY COLUMN nome_fantasia ENUM('Editora A', 'Editora B', 'Editora C');

ALTER TABLE financiador 
MODIFY COLUMN nome VARCHAR(80) DEFAULT ('Financiador Público');

INSERT INTO livro
(preco,categoria)
VALUES
(12, 'Horror'),
(-13, 'Ficção');

INSERT INTO editora
(nome_fantasia, razao_social)
VALUES
('Editora da Silva', 'teste2');

INSERT INTO financiador
(cnpj)
VALUES
(123131312);

SELECT * FROM financiador;


