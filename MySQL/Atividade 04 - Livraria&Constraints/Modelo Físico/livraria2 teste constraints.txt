CREATE DATABASE livraria2;

USE livraria2;

CREATE TABLE cliente(
id_cliente INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(80) NOT NULL,
rg INT, 
cpf BIGINT(11) UNIQUE,
pais VARCHAR(80) DEFAULT 'Brasil',
cidade VARCHAR(75),
bairro VARCHAR(75),
rua VARCHAR(75),
numero_casa INT
);

CREATE TABLE financiador(
id_financiador INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(80),
cnpj BIGINT(14)
);

CREATE TABLE autor(
id_autor INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(80) NOT NULL,
rg INT
);

CREATE TABLE editora(
id_editora INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
nome_fantasia VARCHAR(80) NOT NULL,
razao_social VARCHAR(80) NOT NULL,
pais VARCHAR(80) DEFAULT('Brasil'),
estado VARCHAR(80),
cidade VARCHAR(80),
rua VARCHAR(80),
numero_casa VARCHAR(80),
telefone BIGINT
);

CREATE TABLE livro(
id_livro INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
isbn BIGINT,
titulo VARCHAR(80),
preco DECIMAL(8,2),
categoria ENUM('Horror', 'Ficção', 'Romance', 'Ação'),
financiador_id INT,
autor_id INT,
editora_id INT,
FOREIGN KEY (financiador_id)
REFERENCES financiador(id_financiador),
FOREIGN KEY (autor_id)
REFERENCES autor(id_autor),
FOREIGN KEY (editora_id)
REFERENCES editora(id_editora)
);

CREATE TABLE pedido(
id_pedido INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
livro_id INT,
cliente_id INT,
qtd_pedido INT,
CHECK (qtd_pedido >=0),
FOREIGN KEY (livro_id)
REFERENCES livro(id_livro),
FOREIGN KEY (cliente_id)
REFERENCES cliente(id_cliente)
);


SELECT * FROM cliente;
SELECT * FROM financiador;
SELECT * FROM autor;
SELECT * FROM editora;
SELECT * FROM livro;
SELECT * FROM pedido;

-- Checar Editora

INSERT INTO editora
(razao_social)
VALUES
('Tal tal');

INSERT INTO autor (rg)
VALUE (1231232);

-- Teste CPF duplicado, not null e default
INSERT INTO cliente 
(cpf, nome)
VALUES
(123123113, 'Gustavo'),
(123123113, 'Benjamin');

-- Constraint de check no pedido
INSERT INTO pedido
(qtd_pedido)
VALUES
(-1);

INSERT INTO livro
(categoria)
VALUES
('Horror'),
('Teste');





